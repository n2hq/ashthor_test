import{j as e}from"./jsx-runtime-0DLF9kdB.js";import{r as t,d as K}from"./components-CqyJs_9b.js";import{A as q}from"./AccountLayout-CmmwqolQ.js";import{u as G}from"./AuthContext-BH94oN1s.js";import{u as Q,a as X}from"./zod-DwrW5z8F.js";import{a6 as ee,a7 as F,a8 as V,u as te,f as oe,a9 as se,aa as re,ab as ne,ac as ae,L as ie}from"./lib-d-OCgvip.js";import{I as d}from"./Input-BeAIIpia.js";import{S}from"./Select-BH9z6CRZ.js";import{B as ce}from"./Button-7Woa2p3a.js";import{f as le,c as me}from"./css-CVxtJxAn.js";import{T as ue}from"./TextareaWithWordLimit-Bndj7ite.js";import{C as de}from"./CreatePageSchema-Cx5KYOuQ.js";import{u as fe}from"./NotificationContext-CJEyd20o.js";import{u as he,O as ge}from"./OperationContext-BdFCpeXF.js";import{p as pe,P as Se,S as ye,I as xe}from"./SelectCurrency-DU0YUvuS.js";import{P as we}from"./ProfileContentLayout-D5jIdXrH.js";import{L as Ce}from"./LoadingMessage-B9wZrrAy.js";import"./LeftNav-Cj9_gra7.js";import"./HomeNav-C5gVOegL.js";import"./MainNav-CfGQQoVl.js";import"./index-CTCnFI3k.js";import"./types-DBTFAyTi.js";import"./BusinessMenu-CYgnqm1J.js";const Pe=({data:m,user:a})=>{const[f,b]=t.useState(null),[y,x]=t.useState(!1);fe(),K();const{showOperation:h,showSuccess:T,showError:g,showWarning:M,showInfo:R,completeOperation:w}=he(),I=m.currencies,j=m.countries;let[C,v]=t.useState(m.states),[U,A]=t.useState(m.cities);const B=ee,[L,P]=t.useState(""),[c,J]=t.useState(""),[N,k]=t.useState(""),[E,D]=t.useState(""),_=async o=>{P(o),k(o);const u=await F(o);v(u),$("")},$=async o=>{J(o),D(o);const u=await V(L,o);A(u)},s=o=>{let u=o.target.value,W=o.target.name;b(i=>({...i,[W]:u}))},Y=async o=>{o.first_name=a.first_name,o.last_name=a.last_name,console.log(o),x(!0),h("processing","Creating a page"),await new Promise(l=>setTimeout(l,1e3)),o.owner=a.guid;const W=oe.BASE_URL+"/api/listing";try{const l=await fetch(W,{method:"POST",headers:te,body:JSON.stringify(o)});if(l.ok)T("success","Page created successfully."),h("processing","Redirecting..."),await new Promise(H=>setTimeout(H,4e3)),window.location.href="/web/account/portfolio",w();else{var i=await l.json();throw new Error(`Error Code: ${l.status} - ${(i==null?void 0:i.message)||(i==null?void 0:i.error)}`)}}catch(l){g("Error",l.message),w()}finally{x(!1)}},{register:r,handleSubmit:O,getValues:z,watch:Z,setValue:p,setError:Ne,formState:{errors:n,isSubmitting:Ee}}=Q({resolver:X(de)});return t.useEffect(()=>{N&&(p("state_code",""),p("city_id",""))},[N]),t.useEffect(()=>{E&&p("city_id","")},[E]),e.jsx("form",{onSubmit:O(Y),children:e.jsxs("div",{className:`${le} mt-0  rounded-lg pt-4
                             max-w-[500px] w-full mx-auto `,children:[e.jsx(d,{controlTitle:"Business Name",controlPlaceholder:"Enter business name",controlName:"title",register:r,changeHandler:s,error:n.title,width:80,controlInformation:"Business name is compulsory."}),e.jsx(S,{controlTitle:"Page Type",controlName:"pagetype",controlPlaceholder:"Select Page Type",selectJson:pe,register:r,changeHandler:s,error:n.pagetype,controlInformation:"Select business category."}),e.jsx(d,{controlTitle:"Email Address",controlPlaceholder:"Enter email address",controlName:"email_address",register:r,changeHandler:s,error:n.email_address,controlInformation:"Email address is compulsory."}),e.jsx(S,{controlTitle:"Business Category",controlName:"category",controlPlaceholder:"Select business category",selectJson:B,register:r,changeHandler:s,error:n.category,controlInformation:"Select business category."}),e.jsx(d,{controlTitle:"Address 1",controlPlaceholder:"Enter address",controlName:"address_one",register:r,changeHandler:s,error:n.address_one,width:100,controlInformation:"Address of Business. E.g. 28 New York Street "}),e.jsx(d,{controlTitle:"Address 2",controlPlaceholder:"Enter address",controlName:"address_two",register:r,changeHandler:s,error:n.address_two,width:100,controlInformation:"Continuation of address. E.g. Crown Tower, Off Belleveu Avenue or Valu Complex, Kingston Donnel Boulevard. "}),e.jsx(S,{controlTitle:"Country",controlName:"country_code",controlPlaceholder:"Select country",selectJson:j,register:r,changeHandler:s,error:n.country_code,setCode:_,controlInformation:"Country the business was registered or active. "}),e.jsx(S,{controlTitle:"State",controlName:"state_code",controlPlaceholder:"Select state",selectJson:C,register:r,changeHandler:s,error:n.state_code,setCode:$,controlInformation:"State the business is registered or active. "}),e.jsx(S,{controlTitle:"City",controlName:"city_id",controlPlaceholder:"Select city",selectJson:U,register:r,changeHandler:s,error:n.city_id,controlInformation:"City the business is registered or active. "}),e.jsx(d,{controlTitle:"Zipcode",controlPlaceholder:"Enter zipcode",controlName:"zipcode",register:r,changeHandler:s,error:n.zipcode,controlInformation:"Zipcode of location of business. Eg. 92829 or 239484 "}),e.jsx(Se,{controlTitle:"Phone number",controlPlaceholder:"Enter phone number",controlName:"phone",register:r,setValue:p,getValues:z,changeHandler:s,error:n.phone,controlInformation:"Phone OR Mobile number. "}),e.jsxs("div",{className:"w-full mt-4 mb-12",children:[e.jsx("div",{className:"text-2xl font-semibold",children:"Minimum rate charged by this business."}),e.jsx("div",{className:"text-[14px] py-4 mb-0 leading-[1.3em]",children:"Select the minimum amount customers or clients are charged to purchase goods/services from this business. This is optional."}),e.jsxs("div",{className:"p-4 border rounded-xl",children:[e.jsx(ye,{controlTitle:"Currency",controlName:"minimum_amount_currency_code",controlPlaceholder:"Select currency",selectJson:I,register:r,changeHandler:s,error:n.country_code,setCode:_,controlInformation:"Default currency to receive funds."}),e.jsx("div",{className:"h-2"}),e.jsx(xe,{controlTitle:"Minimum amount charged",controlPlaceholder:"Starting amount. E.g. 10 or 30...",controlName:"minimum_amount",register:r,changeHandler:s,error:n.established,controlInformation:"Enter the starting amount charged by this business"})]})]}),e.jsx(d,{controlTitle:"Year established - Optional",controlPlaceholder:"Enter year established",controlName:"established",register:r,changeHandler:s,error:n.established,controlInformation:"Year registered is compulsory."}),e.jsx(ue,{controlTitle:"Short Description",controlPlaceholder:"Short description",controlName:"short_description",register:r,changeHandler:s,error:n.short_description,setValue:p,getValues:z,watch:Z,controlInformationClass:me,controlInformation:"Enter a short description of this business. It should be a maximum of 50 words. "}),e.jsx(ce,{working:y})]})})},He=()=>{const m=localStorage==null?void 0:localStorage.getItem("authTokens");se(m);const a=G();if(!a)return null;const[f,b]=t.useState(null),[y,x]=t.useState(!0),[h,T]=t.useState(null),[g,M]=t.useState(null),[R,w]=t.useState(null),[I,j]=t.useState(null),[C,v]=t.useState(null),[U,A]=t.useState(null),[B,L]=t.useState(void 0);return t.useEffect(()=>{const P=async c=>{const J=await re(),N=await F(""),k=await V("",""),E=await ne(),D=await ae(),_=await ie((c==null?void 0:c.guid)||"");A(_),M(J),w(N),j(k),v(E),b(c),L(D)};try{a!=null&&a.user&&P(a==null?void 0:a.user)}catch(c){console.log(c.message)}},[a]),t.useEffect(()=>{f&&g&&C&&(T({user:f,countries:g,states:R,cities:I,categories:C,currencies:B}),x(!1))},[g,f]),y?e.jsx(Ce,{loading:y}):e.jsx(q,{children:e.jsx(we,{title:"Create Page",children:e.jsx(ge,{children:h&&e.jsx("div",{children:e.jsx(Pe,{data:h,user:f})})})})})};export{He as default};
