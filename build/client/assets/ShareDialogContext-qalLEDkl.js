import{j as e}from"./jsx-runtime-0DLF9kdB.js";import{r as i,c as M}from"./components-CqyJs_9b.js";import{B as A,y as U,Q as q,f as T,P as V,an as O,ao as W,ap as G,aq as D,k as H,m as z,r as Q,t as Y,ar as J,as as K,at as X,au as Z,av as ee,aw as te,ax as re}from"./lib-BhVPRy-q.js";import{u as se,a as ae}from"./zod-DwrW5z8F.js";import{u as oe}from"./AuthContext-CD4rwEG9.js";import{o as le,a as E,s as w}from"./types-DBTFAyTi.js";const F=i.createContext(null),ce=()=>{const r=i.useContext(F);return r||null},we=({children:r})=>{const[d,u]=i.useState(!1),[s,p]=i.useState();let o={showDialog:u,setListing:p};return e.jsxs(F.Provider,{value:o,children:[d&&e.jsx("div",{children:e.jsx("div",{className:"w-full h-full fixed bg-white top-0 left-0 z-[3000]",children:e.jsx(de,{listing:s})})}),r]})},ne=()=>{const r=ce();return e.jsx("div",{className:"w-[30px] h-[30px] rounded-full bg-white border place-items-center place-content-center cursor-pointer text-3xl",onClick:()=>r==null?void 0:r.showDialog(!1),children:e.jsx(A,{})})},C={QUALITY:"quality",CUSTOMER_SERVICE:"customer_service",COMMUNICATION:"communication",VALUE:"value",OVERALL_SATISFACTION:"overall_satisfaction"},ie=le({quality:w({message:"Please rate qualify of product or service"}).min(1,"Please rate qualify of product or service"),customer_service:w({message:"Please rate customer service experience"}).min(1,"Please rate accuracy"),communication:w({message:"Please rate communication"}).min(1,"Please rate communication"),value:w({message:"Please rate value for money"}).min(1,"Please rate value for money"),overall_satisfaction:w({message:"Please rate your overall satisfaction"}).min(1,"Please rate your overall satisfaction"),title:w({message:"Please enter title"}).min(1,"Please enter title"),experience:w({message:"Please enter experience"}).min(1,"Please write your experience"),avgRating:E(),businessGuid:E(),userGuid:E()}),de=({listing:r})=>{var k,b,a;const d="REVIEW_FORM_DATA",u=oe(),s={title:"",experience:"",quality:"",customer_service:"",communication:"",value:"",overall_satisfaction:"",avgRating:"",businessGuid:"",userGuid:""},p=()=>{try{const t=localStorage.getItem(d);return t?JSON.parse(t):s}catch{return s}},{register:o,handleSubmit:x,watch:v,reset:m,clearErrors:y,formState:{errors:n,isSubmitting:g,isDirty:f}}=se({resolver:ae(ie),defaultValues:p(),mode:"onChange"}),N=()=>{localStorage.removeItem(d),y(),m(s)},R=async t=>{const{quality:h,customer_service:l,communication:c,value:P,overall_satisfaction:L}=t,_=(parseInt(h)+parseInt(l)+parseInt(c)+parseInt(P)+parseInt(L))/5;t.avgRating=_,t.businessGuid=r==null?void 0:r.gid,t.userGuid=u==null?void 0:u.user.guid,console.log("Submitting:",t);try{await new Promise(j=>setTimeout(j,1e3)),localStorage.removeItem(d),y(),m(s)}catch(j){console.error("Submission error:",j),alert("Failed to submit review")}},S=v();return i.useEffect(()=>{f&&localStorage.setItem(d,JSON.stringify(S))},[S,f]),e.jsx("div",{className:"w-full h-full flex place-items-center place-content-center",children:e.jsxs("div",{className:"max-w-full mx-auto w-full h-[100%]",children:[e.jsxs("div",{className:"flex bg-orange-100 py-6 px-5 place-items-center gap-3",children:[e.jsx(ne,{}),e.jsxs("div",{className:"text-2xl ",children:["Tell us, how was your experience at ",e.jsx("span",{className:"text-[18px] font-bold",children:r==null?void 0:r.title})]})]}),e.jsx("form",{onSubmit:x(R),className:"h-[100%] overflow-y-auto px-[20px]",children:e.jsxs("div",{className:"lg:max-w-[80%] mx-auto w-full mt-12",children:[e.jsxs("div",{className:"mt-12 ",children:["Review Title ",n.title&&e.jsx("span",{className:"text-red-500",children:"*"}),e.jsx("div",{className:"text-2xl mb-4",children:"Title of Review?"}),e.jsx("input",{type:"text",...o("title"),placeholder:"Enter title of review.",className:`w-full bg-gray-100 p-6 rounded-2xl outline-none text-xl ${n.title?"border-2 border-red-500":""}`}),n.title&&e.jsx("p",{className:"text-red-500 text-lg mt-2",children:(k=n.title.message)==null?void 0:k.toString()})]}),e.jsxs("div",{className:"mt-12",children:[e.jsx("div",{className:"border-b text-2xl font-bold",children:"Ratings"}),e.jsxs("div",{className:" md:px-8 ",children:[e.jsx(I,{question:"1. How would you rate the quality of product/service?",controlName:C.QUALITY,error:n.quality,register:o}),e.jsx(I,{question:"2. Did you have a good customer service?",controlName:C.CUSTOMER_SERVICE,error:n.customer_service,register:o}),e.jsx(I,{question:"3. How well did they communicate with you?",controlName:C.COMMUNICATION,error:n.communication,register:o}),e.jsx(I,{question:"4. Is it worth your money and time visiting this business?",controlName:C.VALUE,error:n.value,register:o}),e.jsx(I,{question:"5. How would you rate overall satisfaction?",controlName:C.OVERALL_SATISFACTION,error:n.overall_satisfaction,register:o})]})]}),e.jsxs("div",{className:"mt-12",children:[e.jsx("div",{className:"text-2xl mb-3",children:"Write your experience."}),e.jsx("textarea",{...o("experience"),placeholder:"Write your review of this place.",className:`w-[100%] h-[300px] bg-gray-100 rounded-2xl border p-8 text-xl ${n.experience?"border-2 border-red-500":""}`}),n.experience&&e.jsx("p",{className:"text-red-500 text-lg mt-2",children:(a=(b=n==null?void 0:n.experience)==null?void 0:b.message)==null?void 0:a.toString()})]}),e.jsxs("div",{className:"mt-12",children:[e.jsx("button",{type:"submit",className:"bg-gray-900 w-[200px] py-5 rounded-full text-white text-2xl hover:bg-gray-800",disabled:g,children:g?"Submitting...":"Submit"}),e.jsx("button",{type:"button",onClick:N,className:"ml-4 bg-gray-300 w-[200px] py-5 rounded-full text-gray-800 text-2xl hover:bg-gray-400",children:"Clear Form"})]}),e.jsx("div",{className:"h-[200px]"})]})})]})})},I=({question:r,register:d,controlName:u,error:s})=>{var o;const p=["Poor","Fair","Good","Very Good","Excellent"];return e.jsxs("div",{className:"mt-12",children:[e.jsx("div",{className:"text-2xl ",children:r}),e.jsxs("div",{className:"flex flex-col w-full md:w-fit",children:[e.jsx("div",{className:"grid grid-cols-5 gap-4 mt-4 w-full md:w-fit ",children:p.map((x,v)=>{const m=(v+1).toString();return e.jsxs("div",{className:"flex flex-col place-items-center  md:w-[100px] border border-gray-200 rounded-lg py-1 lg:py-2 bg-gray-50 group hover:cursor-pointer",children:[e.jsx("span",{className:"font-semibold",children:m}),e.jsx("label",{className:"relative cursor-pointer",children:e.jsx("input",{type:"radio",...d(u),value:m,className:`w-[30px] h-[30px] border border-gray-500 rounded-full appearance-none
                                            checked:bg-green-700 checked:border-green-700
                                            focus:outline-none focus:ring-2 focus:ring-green-300
                                            transition-all duration-200
                                            group-hover:cursor-pointer
                                        `})}),e.jsx("div",{className:"w-full text-center",children:x})]},v)})}),s&&e.jsx("p",{className:"text-red-500 mt-3 text-lg bg-gray-100 py-2 px-2 rounded-md",children:(o=s.message)==null?void 0:o.toString()})]})]})};function ge(r){return U({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M17 3a2.828 2.828 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5L17 3z"},child:[]}]})(r)}function ue(r){return U({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"},child:[]}]})(r)}const B=i.createContext(null),Se=()=>{const r=i.useContext(B);return r||null};async function xe(r){const d=T.BASE_URL+r.pathname;try{await navigator.clipboard.writeText(d),console.log("URL copied to clipboard:",d)}catch(u){console.error("Failed to copy:",u)}}function pe(r,d){const s=`${T.BASE_URL+d.pathname}?v=${Date.now()}`,p=(r==null?void 0:r.title)+" - "+Q(Y(r==null?void 0:r.short_description,150))+" via @bycetinc",o=encodeURIComponent(s),x=encodeURIComponent(p),v=`https://twitter.com/intent/tweet?url=${o}&text=${x}`,m=`https://www.facebook.com/sharer/sharer.php?u=${o}&quote=${x}`,y=`https://wa.me/?text=${x} ${o}`,n=`Check out ${r==null?void 0:r.title} on Bycet.com`,g=encodeURIComponent(n),f=`${p}

View here: ${s}

Shared via @bycetinc`,N=encodeURIComponent(f),R=`mailto:?subject=${g}&body=${N}`,S=`${p}

View here: ${s}

Shared via @bycetinc`,b=`sms:&body=${encodeURIComponent(S)}`,a=`https://t.me/share/url?url=${o}&text=${x}`,t=`https://www.linkedin.com/sharing/share-offsite/?url=${o}`;let h;return $.map((l,c)=>{l.key==="twitter"&&(l.url=v),l.key==="facebook"&&(l.url=m),l.key==="whatsapp"&&(l.url=y),l.key==="email"&&(l.url=R),l.key==="messages"&&(l.url=b),l.key==="telegram"&&(l.url=a),l.key==="linkedin"&&(l.url=t)}),h=$,h}let $=[{key:"copy",title:"Copy Link",url:"#copy",icon:e.jsx(J,{})},{key:"email",title:"Email",url:"mailto:",icon:e.jsx(K,{})},{key:"whatsapp",title:"Whatsapp",url:"",icon:e.jsx(X,{})},{key:"facebook",title:"Facebook",url:"",icon:e.jsx(Z,{})},{key:"twitter",title:"Twitter",url:"",icon:e.jsx(ee,{})},{key:"messages",title:"Messages",url:"",icon:e.jsx(ue,{})},{key:"telegram",title:"Telegram",url:"",icon:e.jsx(te,{})},{key:"linkedin",title:"LinkedIn",url:"",icon:e.jsx(re,{})}];const Ne=({children:r})=>{var b;const[d,u]=i.useState(!1),[s,p]=i.useState(null),o=M(),[x,v]=i.useState(null),[m,y]=i.useState("Copy Link"),[n,g]=i.useState(""),[f,N]=i.useState(null);i.useEffect(()=>{m==="Link Copied"&&setTimeout(()=>{y("Copy Link")},3e3)},[m]);const[R,S]=i.useState(null);i.useEffect(()=>{s&&(async t=>{const h=[],l=await O(t==null?void 0:t.gid);l==null||l.map((c,P)=>{const L=c==null?void 0:c.user_description,_=W(L);let j="";_?j=L:j=`${c==null?void 0:c.base_url}${c==null?void 0:c.user_description}`,h.push({media:c==null?void 0:c.name,icon:G(c),name:c==null?void 0:c.name,link:j})}),t!=null&&t.website&&h.push({media:t==null?void 0:t.website,icon:e.jsx(D,{}),name:"Website",link:`${t==null?void 0:t.website}`}),t!=null&&t.email_address&&h.push({media:t==null?void 0:t.email_address,icon:e.jsx(H,{}),name:"Email Address",link:`mailto:${t==null?void 0:t.email_address}`}),t!=null&&t.phone&&h.push({media:t==null?void 0:t.phone,icon:e.jsx(z,{}),name:"Phone",link:`tel:${t==null?void 0:t.phone}`}),S(h)})(s)},[s]),i.useEffect(()=>{if(s){const a=pe(s,o);v(a)}},[s]);let k={setShow:u,setListing:p,setProfileImg:g,setProfileImageData:N};return e.jsxs(B.Provider,{value:k,children:[e.jsx("div",{children:d&&e.jsxs("div",{className:"fixed top-0 left-0 w-full right-0 bg-black/40 z-[4000] h-full flex place-items-center place-content-center",onClick:()=>u(!1),children:[e.jsx(me,{setShow:u}),e.jsx("div",{className:"mx-3 w-full",children:e.jsxs("div",{className:"max-w-[560px] mx-auto w-full bg-white h-fit rounded-[40px] px-[24px] py-16 relative",onClick:a=>a.stopPropagation(),children:[e.jsx("div",{className:"absolute top-8 right-8 text-3xl border-[2px] rounded-xl border-gray-500/20 w-[40px] h-[40px] shadow-sm flex place-items-center place-content-center text-gray-500 cursor-pointer hover:bg-gray-100 hover:border-gray-200/50",onClick:()=>u(!1),children:e.jsx(q,{})}),e.jsx("div",{className:"text-3xl",children:"Share this place"}),e.jsxs("div",{className:" mt-8 flex place-items-center place-content-start gap-3",children:[e.jsx("div",{className:"w-[60px] min-w-[60px] h-[60px] relative rounded-lg overflow-hidden",children:f!==null?e.jsx("img",{src:((b=T)==null?void 0:b.IMG_BASE_URL)+(f==null?void 0:f.image_url)||"/images/pcho.png",alt:"",className:"object-cover w-full h-full"}):e.jsx("div",{className:"w-full h-full flex place-items-center place-content-center bg-gray-400 text-gray-100",children:e.jsx("span",{className:"uppercase text-2xl md:text-2xl",children:V((s==null?void 0:s.title)||"")})})}),e.jsx("div",{className:"text-xl ",children:e.jsx("div",{className:"h-full text-gray-700 text-[16px] leading-snug",children:s==null?void 0:s.title})})]}),e.jsx("div",{className:"mt-8 grid grid-cols-2 gap-x-6 gap-y-5",children:x==null?void 0:x.map((a,t)=>e.jsx("div",{children:e.jsx("a",{target:(a==null?void 0:a.key)==="copy"?"_self":"_blank",href:a.url,onClick:async()=>{a.key==="copy"&&(xe(o),y("Link Copied"))},children:e.jsxs("div",{className:"flex place-items-center gap-3 border px-4 py-4 rounded-xl border-gray-300 hover:bg-gray-50",children:[e.jsx("div",{className:"text-2xl",children:a==null?void 0:a.icon}),e.jsx("div",{className:"text-[15px] font-normal",children:(a==null?void 0:a.key)==="copy"?m:a==null?void 0:a.title})]})})},t))}),e.jsxs("div",{className:"mt-6 text-[14px]",children:[e.jsx("b",{children:"Description: "}),s==null?void 0:s.short_description]})]})})]})}),r]})},me=({setShow:r})=>e.jsx("div",{onClick:()=>r(!1),children:e.jsx("div",{className:"w-[30px] h-[30px] flex place-items-center place-content-center rounded-full absolute top-2 left-2 bg-white text-[25px] font-bold transition-all ease-in-out duration-700 cursor-pointer hover:bg-white/40",children:e.jsx(A,{})})});export{ge as F,Ne as S,we as W,Se as a,ce as u};
